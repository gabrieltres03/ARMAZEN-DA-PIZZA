<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Estoque - Pizzaria</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            width: 90%;
            max-width: 1200px;
            min-height: 600px;
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .screen {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .menu-card {
            background: linear-gradient(145deg, #f0f0f0, #ffffff);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
        }

        .menu-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            border-color: #667eea;
        }

        .menu-card h3 {
            color: #333;
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .menu-card p {
            color: #666;
            line-height: 1.6;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .btn-back {
            background: linear-gradient(145deg, #95a5a6, #7f8c8d);
        }

        .btn-danger {
            background: linear-gradient(145deg, #e74c3c, #c0392b);
        }

        .produtos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .produto-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ddd;
            transition: all 0.3s ease;
            text-align: center;
        }

        .produto-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .produto-item h4 {
            color: #333;
            margin-bottom: 5px;
            font-size: 1em;
        }

        .produto-item p {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .produto-item input {
            width: 70px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: center;
        }

        .section-title {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0 15px 0;
            text-align: center;
            font-weight: bold;
        }

        .funcionarios-section {
            background: #f1f3f4;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .funcionario-item {
            display: grid;
            grid-template-columns: 1fr auto auto;
            align-items: center;
            gap: 15px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .funcionario-info {
            display: flex;
            flex-direction: column;
        }

        .funcionario-info h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .funcionario-info p {
            color: #666;
            font-size: 0.9em;
        }

        .motoboys-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .motoboy-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e3f2fd;
            text-align: center;
            transition: all 0.3s ease;
        }

        .motoboy-card.active {
            border-color: #2196f3;
            background: #f3f8ff;
        }

        .motoboy-card h5 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .motoboy-controls {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .motoboy-controls label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 3px;
        }

        .motoboy-controls input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: center;
            font-size: 14px;
        }

        .motoboy-salary {
            margin-top: 8px;
            font-weight: bold;
            color: #2196f3;
            font-size: 0.9em;
        }

        .total-display {
            background: linear-gradient(145deg, #2ecc71, #27ae60);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            font-size: 1.5em;
            font-weight: bold;
        }

        .report-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .summary-card {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .summary-card h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .summary-card .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .report-table th,
        .report-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .report-table th {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
        }

        .report-table tr:hover {
            background: #f8f9fa;
        }

        .entrada {
            color: #27ae60;
            font-weight: 600;
        }

        .saida {
            color: #e74c3c;
            font-weight: 600;
        }

        .funcionario {
            color: #f39c12;
            font-weight: 600;
        }

        .success-message {
            background: linear-gradient(145deg, #2ecc71, #27ae60);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            animation: slideIn 0.5s ease-in-out;
        }

        .data-management {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .data-management h4 {
            color: #333;
            margin-bottom: 15px;
        }

        .data-info {
            background: #e9ecef;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 0.9em;
            color: #666;
        }

        .data-info strong {
            color: #333;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Tela Principal -->
        <div id="main-screen" class="screen active">
            <div class="header">
                <h1>üçï Sistema de Estoque</h1>
                <p>Pizzaria - Controle Completo</p>
            </div>
            
            <div class="menu-grid">
                <div class="menu-card" onclick="showScreen('rec1')">
                    <h3>üì¶ Entrada de Itens</h3>
                    <p>Registrar entrada de ingredientes e materiais no estoque</p>
                </div>
                
                <div class="menu-card" onclick="showScreen('fat1')">
                    <h3>üçï Vendas</h3>
                    <p>Registrar vendas de produtos da pizzaria</p>
                </div>
                
                <div class="menu-card" onclick="showScreen('cust1')">
                    <h3>üë• Custos Pessoal</h3>
                    <p>Controlar despesas com motoboys e funcion√°rios</p>
                </div>
                
                <div class="menu-card" onclick="showScreen('rel1')">
                    <h3>üìä Relat√≥rio Geral</h3>
                    <p>Visualizar relat√≥rios detalhados por per√≠odo</p>
                </div>
                
                <div class="menu-card" onclick="showScreen('config')">
                    <h3>‚öôÔ∏è Configura√ß√µes</h3>
                    <p>Gerenciar dados salvos e configura√ß√µes do sistema</p>
                </div>
            </div>
        </div>

        <!-- Tela REC1 - Entrada de Itens -->
        <div id="rec1-screen" class="screen">
            <div class="header">
                <h1>üì¶ Entrada de Itens</h1>
                <p>Registrar entrada de ingredientes no estoque</p>
            </div>
            
            <form id="entrada-form">
                <div class="form-group">
                    <label for="item-select">Selecionar Item:</label>
                    <select id="item-select" required>
                         <option value="">Escolha um item...</option>
                        <option value="abacaxi">Abacaxi em calda</option>
                        <option value="alho-frito">Alho frito</option>
                        <option value="amendoim">Amendoim</option>
                        <option value="atum">Atum</option>
                        <option value="bacon">Bacon</option>
                        <option value="banana">Banana</option>
                        <option value="batata-palha">Batata palha</option>
                        <option value="bombom-branco">Bombom branco</option>
                        <option value="bombom-preto">Bombom preto</option>
                        <option value="brocolos">Br√≥colis</option>
                        <option value="calabresa">Calabresa</option>
                        <option value="bisnaga-chocolate">Bisnaga de chocolate</option>
                        <option value="cebola">Cebola</option>
                        <option value="cebola-caramelizada">Cebola caramelizada</option>
                        <option value="cebola-roxa">Cebola roxa</option>
                        <option value="champignon">Champignon</option>
                        <option value="chocolate-branco">Chocolate branco Nestl√©</option>
                        <option value="chocolate-preto">Chocolate preto Nestl√©</option>
                        <option value="chokito">Chokito</option>
                        <option value="coracao-frango">Cora√ß√£o de frango</option>
                        <option value="creme-leite">Creme de leite</option>
                        <option value="doritos">Doritos</option>
                        <option value="doce-leite">Doce de leite</option>
                        <option value="frango">Frango</option>
                        <option value="goiabada">Goiabada</option>
                        <option value="lombo">Lombo</option>
                        <option value="maca-verde">Ma√ß√£ verde</option>
                        <option value="manjericao">Manjeric√£o</option>
                        <option value="milho">Milho</option>
                        <option value="morango">Morango</option>
                        <option value="mussarela">Mussarela</option>
                        <option value="nozes">Nozes</option>
                        <option value="nutella">Nutella</option>
                        <option value="oregano">Or√©gano</option>
                        <option value="palmito">Palmito</option>
                        <option value="parmesao">Parmes√£o</option>
                        <option value="peito-peru">Peito de peru</option>
                        <option value="pepperoni">Pepperoni</option>
                        <option value="pimentao">Piment√£o</option>
                        <option value="pimenta-calabresa">Pimenta calabresa</option>
                        <option value="presunto">Presunto</option>
                        <option value="provolone">Provolone</option>
                        <option value="queijo-cheddar">Queijo cheddar</option>
                        <option value="queijo-gorgonzola">Queijo gorgonzola</option>
                        <option value="requeijao">Requeij√£o</option>
                        <option value="rucula">R√∫cula</option>
                        <option value="stikadinho">Stikadinho</option>
                        <option value="tomate">Tomate</option>
                        <option value="tomate-cereja">Tomate cereja</option>
                        <option value="tomate-seco">Tomate seco</option>
                        <option value="uva-verde">Uva verde</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="quantidade">Quantidade:</label>
                    <input type="number" id="quantidade" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="valor-unitario">Valor Unit√°rio (R$):</label>
                    <input type="number" id="valor-unitario" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="data-entrada">Data:</label>
                    <input type="date" id="data-entrada" required>
                </div>
                
                <button type="submit" class="btn">üíæ Registrar Entrada</button>
                <button type="button" class="btn btn-back" onclick="showScreen('main')">üîô Voltar</button>
            </form>
        </div>

        <!-- Tela FAT1 - Vendas -->
        <div id="fat1-screen" class="screen">
            <div class="header">
                <h1>üçï Registro de Vendas</h1>
                <p>Registrar vendas de produtos da pizzaria</p>
            </div>
            
            <form id="venda-form">
                <div class="section-title">üçï PIZZAS</div>
                <div class="produtos-grid">
                    <div class="produto-item">
                        <h4>Pizza Pequena</h4>
                        <p>R$ 70,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="pizza-pequena" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                    
                    <div class="produto-item">
                        <h4>Pizza M√©dia</h4>
                        <p>R$ 95,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="pizza-media" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                    
                    <div class="produto-item">
                        <h4>Pizza Grande</h4>
                        <p>R$ 105,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="pizza-grande" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                    
                    <div class="produto-item">
                        <h4>Pizza Gigante</h4>
                        <p>R$ 125,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="pizza-gigante" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                </div>

                <div class="section-title">ü•ü ESFIRRAS</div>
                <div class="produtos-grid">
                    <div class="produto-item">
                        <h4>Esfirra Doce</h4>
                        <p>R$ 10,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="esfirra-doce" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                    
                    <div class="produto-item">
                        <h4>Esfirra Salgada</h4>
                        <p>R$ 10,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="esfirra-salgada" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                </div>
                
                <div class="total-display" id="total-vendas-display">
                    <strong>Total de Vendas: R$ 0,00</strong>
                </div>
                
                <div class="form-group">
                    <label for="data-venda">Data:</label>
                    <input type="date" id="data-venda" required>
                </div>
                
                <button type="submit" class="btn">üí∞ Registrar Vendas</button>
                <button type="button" class="btn btn-back" onclick="showScreen('main')">üîô Voltar</button>
            </form>
        </div>

        <!-- Tela CUST1 - Custos com Pessoal -->
        <div id="cust1-screen" class="screen">
            <div class="header">
                <h1>üë• Custos com Pessoal</h1>
                <p>Controlar despesas com motoboys e funcion√°rios</p>
            </div>
            
            <form id="custos-form">
                <div class="section-title">üèçÔ∏è MOTOBOYS</div>
                <div class="funcionarios-section">
                    <div class="funcionario-item">
                        <div class="funcionario-info">
                            <h4>Sistema de Pagamento</h4>
                            <p>R$ 70,00 at√© 7 entregas + R$ 10,00 por entrega extra</p>
                        </div>
                    </div>
                    
                    <div class="motoboys-grid">
                        <div class="motoboy-card" id="motoboy-1">
                            <h5>Motoboy 1</h5>
                            <div class="motoboy-controls">
                                <label>
                                    <input type="checkbox" id="motoboy-1-ativo" onchange="toggleMotoboy(1)"> Trabalhou hoje
                                </label>
                                <label>Entregas:</label>
                                <input type="number" id="motoboy-1-entregas" min="0" value="0" onchange="calcularTotalCustos()" disabled>
                                <div class="motoboy-salary" id="motoboy-1-salary">R$ 0,00</div>
                            </div>
                        </div>
                        
                        <div class="motoboy-card" id="motoboy-2">
                            <h5>Motoboy 2</h5>
                            <div class="motoboy-controls">
                                <label>
                                    <input type="checkbox" id="motoboy-2-ativo" onchange="toggleMotoboy(2)"> Trabalhou hoje
                                </label>
                                <label>Entregas:</label>
                                <input type="number" id="motoboy-2-entregas" min="0" value="0" onchange="calcularTotalCustos()" disabled>
                                <div class="motoboy-salary" id="motoboy-2-salary">R$ 0,00</div>
                            </div>
                        </div>
                        
                        <div class="motoboy-card" id="motoboy-3">
                            <h5>Motoboy 3</h5>
                            <div class="motoboy-controls">
                                <label>
                                    <input type="checkbox" id="motoboy-3-ativo" onchange="toggleMotoboy(3)"> Trabalhou hoje
                                </label>
                                <label>Entregas:</label>
                                <input type="number" id="motoboy-3-entregas" min="0" value="0" onchange="calcularTotalCustos()" disabled>
                                <div class="motoboy-salary" id="motoboy-3-salary">R$ 0,00</div>
                            </div>
                        </div>
                        
                        <div class="motoboy-card" id="motoboy-4">
                            <h5>Motoboy 4</h5>
                            <div class="motoboy-controls">
                                <label>
                                    <input type="checkbox" id="motoboy-4-ativo" onchange="toggleMotoboy(4)"> Trabalhou hoje
                                </label>
                                <label>Entregas:</label>
                                <input type="number" id="motoboy-4-entregas" min="0" value="0" onchange="calcularTotalCustos()" disabled>
                                <div class="motoboy-salary" id="motoboy-4-salary">R$ 0,00</div>
                            </div>
                        </div>
                        
                        <div class="motoboy-card" id="motoboy-5">
                            <h5>Motoboy 5</h5>
                            <div class="motoboy-controls">
                                <label>
                                    <input type="checkbox" id="motoboy-5-ativo" onchange="toggleMotoboy(5)"> Trabalhou hoje
                                </label>
                                <label>Entregas:</label>
                                <input type="number" id="motoboy-5-entregas" min="0" value="0" onchange="calcularTotalCustos()" disabled>
                                <div class="motoboy-salary" id="motoboy-5-salary">R$ 0,00</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-title">üë®‚Äçüç≥ OUTROS FUNCION√ÅRIOS</div>
                <div class="funcionarios-section">
                    <div class="funcionario-item">
                        <div class="funcionario-info">
                            <h4>üë®‚Äçüç≥ Auxiliares de Cozinha</h4>
                            <p>R$ 80,00 por di√°ria</p>
                        </div>
                        <div>
                            <label>Qtd Trabalhando:</label>
                            <input type="number" id="auxiliares-trabalhando" min="0" max="5" value="0" onchange="calcularTotalCustos()">
                        </div>
                        <div></div>
                    </div>
                </div>
                
                <div class="total-display" id="total-custos-display">
                    <div>Total Motoboys: R$ 0,00</div>
                    <div>Total Auxiliares: R$ 0,00</div>
                    <div style="border-top: 2px solid white; padding-top: 10px; margin-top: 10px;">
                        <strong>Total Custos Pessoal: R$ 0,00</strong>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="data-custos">Data:</label>
                    <input type="date" id="data-custos" required>
                </div>
                
                <button type="submit" class="btn">üí∏ Registrar Custos</button>
                <button type="button" class="btn btn-back" onclick="showScreen('main')">üîô Voltar</button>
            </form>
        </div>

        <!-- Tela REL1 - Relat√≥rio -->
        <div id="rel1-screen" class="screen">
            <div class="header">
                <h1>üìä Relat√≥rio Geral</h1>
                <p>An√°lise completa por per√≠odo</p>
            </div>
            
            <form id="relatorio-form">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label for="data-inicio">Data In√≠cio:</label>
                        <input type="date" id="data-inicio" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="data-fim">Data Fim:</label>
                        <input type="date" id="data-fim" required>
                    </div>
                </div>
                
                <button type="submit" class="btn">üìà Gerar Relat√≥rio</button>
                        <button type="button" class="btn" onclick="exportarRelatorio()">üìÑ Exportar PDF</button>
                <button type="button" class="btn btn-back" onclick="showScreen('main')">üîô Voltar</button>
            </form>
            
            <div id="relatorio-resultado" style="display: none;">
                <div class="report-summary" id="resumo-relatorio">
                    <!-- Resumo ser√° gerado dinamicamente -->
                </div>
                
                <table class="report-table" id="tabela-relatorio">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Tipo</th>
                            <th>Descri√ß√£o</th>
                            <th>Quantidade</th>
                            <th>Valor Unit.</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody id="corpo-relatorio">
                        <!-- Dados ser√£o inseridos dinamicamente -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Tela Configura√ß√µes -->
        <div id="config-screen" class="screen">
            <div class="header">
                <h1>‚öôÔ∏è Configura√ß√µes</h1>
                <p>Gerenciar dados salvos e configura√ß√µes do sistema</p>
            </div>
            
            <div class="data-management">
                <h4>üíæ Gerenciamento de Dados</h4>
                
                <div class="data-info">
                    <strong>Dados Armazenados:</strong><br>
                    Entradas: <span id="count-entradas">0</span> registros<br>
                    Vendas: <span id="count-vendas">0</span> registros<br>
                    Custos: <span id="count-custos">0</span> registros
                </div>
                
                <div style="margin: 20px 0;">
                    <button class="btn" onclick="exportarDados()">üì§ Exportar Dados</button>
                    <button class="btn" onclick="importarDados()">üì• Importar Dados</button>
                    <input type="file" id="arquivo-importacao" accept=".json" style="display: none;" onchange="processarImportacao()">
                </div>
                
                <div style="margin: 20px 0;">
                    <button class="btn btn-danger" onclick="limparDados()">üóëÔ∏è Limpar Todos os Dados</button>
                </div>
                
                <button type="button" class="btn btn-back" onclick="showScreen('main')">üîô Voltar</button>
            </div>
        </div>
    </div>

    <script>
        // Estruturas de dados
        let entradas = JSON.parse(localStorage.getItem('pizzaria_entradas') || '[]');
        let vendas = JSON.parse(localStorage.getItem('pizzaria_vendas') || '[]');
        let custos = JSON.parse(localStorage.getItem('pizzaria_custos') || '[]');

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            // Definir data atual como padr√£o
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById('data-entrada').value = hoje;
            document.getElementById('data-venda').value = hoje;
            document.getElementById('data-custos').value = hoje;
            document.getElementById('data-inicio').value = hoje;
            document.getElementById('data-fim').value = hoje;
            
            atualizarContadores();
            calcularTotalVendas();
            calcularTotalCustos();
        });

        // Navega√ß√£o entre telas
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId + '-screen').classList.add('active');
        }

        // REC1 - Entrada de Itens
        document.getElementById('entrada-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const entrada = {
                id: Date.now(),
                item: document.getElementById('item-select').value,
                quantidade: parseFloat(document.getElementById('quantidade').value),
                valorUnitario: parseFloat(document.getElementById('valor-unitario').value),
                data: document.getElementById('data-entrada').value,
                total: parseFloat(document.getElementById('quantidade').value) * parseFloat(document.getElementById('valor-unitario').value)
            };
            
            entradas.push(entrada);
            localStorage.setItem('pizzaria_entradas', JSON.stringify(entradas));
            
            mostrarMensagemSucesso('Entrada registrada com sucesso!');
            this.reset();
            document.getElementById('data-entrada').value = new Date().toISOString().split('T')[0];
            atualizarContadores();
        });

        // FAT1 - Vendas
        const precos = {
            'pizza-pequena': 70.00,
            'pizza-media': 95.00,
            'pizza-grande': 105.00,
            'pizza-gigante': 125.00,
            'esfirra-doce': 10.00,
            'esfirra-salgada': 10.00
        };

        function calcularTotalVendas() {
            let total = 0;
            
            Object.keys(precos).forEach(produto => {
                const quantidade = parseInt(document.getElementById(produto).value) || 0;
                total += quantidade * precos[produto];
            });
            
            document.getElementById('total-vendas-display').innerHTML = 
                `<strong>Total de Vendas: R$ ${total.toFixed(2)}</strong>`;
        }

        document.getElementById('venda-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const venda = {
                id: Date.now(),
                data: document.getElementById('data-venda').value,
                produtos: {},
                total: 0
            };
            
            Object.keys(precos).forEach(produto => {
                const quantidade = parseInt(document.getElementById(produto).value) || 0;
                if (quantidade > 0) {
                    venda.produtos[produto] = {
                        quantidade: quantidade,
                        preco: precos[produto],
                        subtotal: quantidade * precos[produto]
                    };
                    venda.total += quantidade * precos[produto];
                }
            });
            
            if (venda.total > 0) {
                vendas.push(venda);
                localStorage.setItem('pizzaria_vendas', JSON.stringify(vendas));
                
                mostrarMensagemSucesso(`Vendas registradas! Total: R$ ${venda.total.toFixed(2)}`);
                this.reset();
                document.getElementById('data-venda').value = new Date().toISOString().split('T')[0];
                calcularTotalVendas();
                atualizarContadores();
            } else {
                alert('Adicione pelo menos um produto para registrar a venda!');
            }
        });

        // CUST1 - Custos com Pessoal
        function toggleMotoboy(numero) {
            const checkbox = document.getElementById(`motoboy-${numero}-ativo`);
            const input = document.getElementById(`motoboy-${numero}-entregas`);
            const card = document.getElementById(`motoboy-${numero}`);
            
            if (checkbox.checked) {
                input.disabled = false;
                card.classList.add('active');
                input.value = 7; // Valor padr√£o
            } else {
                input.disabled = true;
                card.classList.remove('active');
                input.value = 0;
            }
            
            calcularTotalCustos();
        }

        function calcularTotalCustos() {
            let totalMotoboys = 0;
            let totalAuxiliares = 0;
            
            // Calcular custos dos motoboys
            for (let i = 1; i <= 5; i++) {
                const checkbox = document.getElementById(`motoboy-${i}-ativo`);
                const entregas = parseInt(document.getElementById(`motoboy-${i}-entregas`).value) || 0;
                const salaryDiv = document.getElementById(`motoboy-${i}-salary`);
                
                if (checkbox.checked) {
                    let salario = 70; // Base
                    if (entregas > 7) {
                        salario += (entregas - 7) * 10;
                    }
                    totalMotoboys += salario;
                    salaryDiv.textContent = `R$ ${salario.toFixed(2)}`;
                } else {
                    salaryDiv.textContent = 'R$ 0,00';
                }
            }
            
            // Calcular custos dos auxiliares
            const auxiliares = parseInt(document.getElementById('auxiliares-trabalhando').value) || 0;
            totalAuxiliares = auxiliares * 80;
            
            const totalGeral = totalMotoboys + totalAuxiliares;
            
            document.getElementById('total-custos-display').innerHTML = `
                <div>Total Motoboys: R$ ${totalMotoboys.toFixed(2)}</div>
                <div>Total Auxiliares: R$ ${totalAuxiliares.toFixed(2)}</div>
                <div style="border-top: 2px solid white; padding-top: 10px; margin-top: 10px;">
                    <strong>Total Custos Pessoal: R$ ${totalGeral.toFixed(2)}</strong>
                </div>
            `;
        }

        document.getElementById('custos-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const custo = {
                id: Date.now(),
                data: document.getElementById('data-custos').value,
                motoboys: [],
                auxiliares: parseInt(document.getElementById('auxiliares-trabalhando').value) || 0,
                totalMotoboys: 0,
                totalAuxiliares: 0,
                total: 0
            };
            
            // Processar motoboys
            for (let i = 1; i <= 5; i++) {
                const checkbox = document.getElementById(`motoboy-${i}-ativo`);
                const entregas = parseInt(document.getElementById(`motoboy-${i}-entregas`).value) || 0;
                
                if (checkbox.checked) {
                    let salario = 70;
                    if (entregas > 7) {
                        salario += (entregas - 7) * 10;
                    }
                    
                    custo.motoboys.push({
                        numero: i,
                        entregas: entregas,
                        salario: salario
                    });
                    
                    custo.totalMotoboys += salario;
                }
            }
            
            custo.totalAuxiliares = custo.auxiliares * 80;
            custo.total = custo.totalMotoboys + custo.totalAuxiliares;
            
            custos.push(custo);
            localStorage.setItem('pizzaria_custos', JSON.stringify(custos));
            
            mostrarMensagemSucesso(`Custos registrados! Total: R$ ${custo.total.toFixed(2)}`);
            this.reset();
            document.getElementById('data-custos').value = new Date().toISOString().split('T')[0];
            
            // Reset dos motoboys
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`motoboy-${i}-ativo`).checked = false;
                document.getElementById(`motoboy-${i}-entregas`).disabled = true;
                document.getElementById(`motoboy-${i}-entregas`).value = 0;
                document.getElementById(`motoboy-${i}`).classList.remove('active');
                document.getElementById(`motoboy-${i}-salary`).textContent = 'R$ 0,00';
            }
            
            calcularTotalCustos();
            atualizarContadores();
        });

        // REL1 - Relat√≥rios
        document.getElementById('relatorio-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const dataInicio = document.getElementById('data-inicio').value;
            const dataFim = document.getElementById('data-fim').value;
            
            gerarRelatorio(dataInicio, dataFim);
            document.getElementById('relatorio-resultado').style.display = 'block';
        });

        function gerarRelatorio(dataInicio, dataFim) {
            const resumo = {
                totalEntradas: 0,
                totalVendas: 0,
                totalCustos: 0,
                lucro: 0,
                itensEntrada: 0,
                registrosVenda: 0,
                registrosCusto: 0
            };
            
            const dados = [];
            
            // Processar entradas
            entradas.forEach(entrada => {
                if (entrada.data >= dataInicio && entrada.data <= dataFim) {
                    resumo.totalEntradas += entrada.total;
                    resumo.itensEntrada++;
                    
                    dados.push({
                        data: entrada.data,
                        tipo: 'Entrada',
                        descricao: entrada.item,
                        quantidade: entrada.quantidade,
                        valorUnit: entrada.valorUnitario,
                        total: entrada.total,
                        classe: 'entrada'
                    });
                }
            });
            
            // Processar vendas
            vendas.forEach(venda => {
                if (venda.data >= dataInicio && venda.data <= dataFim) {
                    resumo.totalVendas += venda.total;
                    resumo.registrosVenda++;
                    
                    Object.keys(venda.produtos).forEach(produto => {
                        const produtoData = venda.produtos[produto];
                        dados.push({
                            data: venda.data,
                            tipo: 'Venda',
                            descricao: produto.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase()),
                            quantidade: produtoData.quantidade,
                            valorUnit: produtoData.preco,
                            total: produtoData.subtotal,
                            classe: 'saida'
                        });
                    });
                }
            });
            
            // Processar custos
            custos.forEach(custo => {
                if (custo.data >= dataInicio && custo.data <= dataFim) {
                    resumo.totalCustos += custo.total;
                    resumo.registrosCusto++;
                    
                    // Motoboys
                    custo.motoboys.forEach(motoboy => {
                        dados.push({
                            data: custo.data,
                            tipo: 'Custo',
                            descricao: `Motoboy ${motoboy.numero} (${motoboy.entregas} entregas)`,
                            quantidade: 1,
                            valorUnit: motoboy.salario,
                            total: motoboy.salario,
                            classe: 'funcionario'
                        });
                    });
                    
                    // Auxiliares
                    if (custo.auxiliares > 0) {
                        dados.push({
                            data: custo.data,
                            tipo: 'Custo',
                            descricao: `Auxiliares de Cozinha (${custo.auxiliares})`,
                            quantidade: custo.auxiliares,
                            valorUnit: 80,
                            total: custo.totalAuxiliares,
                            classe: 'funcionario'
                        });
                    }
                }
            });
            
            resumo.lucro = resumo.totalVendas - resumo.totalEntradas - resumo.totalCustos;
            
            // Ordenar dados por data
            dados.sort((a, b) => new Date(a.data) - new Date(b.data));
            
            // Exibir resumo
            document.getElementById('resumo-relatorio').innerHTML = `
                <div class="summary-card">
                    <h4>üí∞ Total Vendas</h4>
                    <div class="value">R$ ${resumo.totalVendas.toFixed(2)}</div>
                </div>
                <div class="summary-card">
                    <h4>üì¶ Total Entradas</h4>
                    <div class="value">R$ ${resumo.totalEntradas.toFixed(2)}</div>
                </div>
                <div class="summary-card">
                    <h4>üë• Total Custos</h4>
                    <div class="value">R$ ${resumo.totalCustos.toFixed(2)}</div>
                </div>
                <div class="summary-card">
                    <h4>üìà Lucro L√≠quido</h4>
                    <div class="value" style="color: ${resumo.lucro >= 0 ? '#27ae60' : '#e74c3c'}">
                        R$ ${resumo.lucro.toFixed(2)}
                    </div>
                </div>
            `;
            
            // Exibir tabela
            const corpo = document.getElementById('corpo-relatorio');
            corpo.innerHTML = '';
            
            dados.forEach(item => {
                const row = corpo.insertRow();
                row.innerHTML = `
                    <td>${new Date(item.data).toLocaleDateString('pt-BR')}</td>
                    <td class="${item.classe}">${item.tipo}</td>
                    <td>${item.descricao}</td>
                    <td>${item.quantidade}</td>
                    <td>R$ ${item.valorUnit.toFixed(2)}</td>
                    <td class="${item.classe}">R$ ${item.total.toFixed(2)}</td>
                `;
            });
            
            // Salvar dados do relat√≥rio para exporta√ß√£o
            window.dadosRelatorio = { resumo, dados, dataInicio, dataFim };
        }

        function exportarRelatorio() {
            if (!window.dadosRelatorio) {
                alert('Gere um relat√≥rio primeiro!');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // T√≠tulo
            doc.setFontSize(20);
            doc.text('Relat√≥rio Pizzaria', 20, 20);
            
            doc.setFontSize(12);
            doc.text(`Per√≠odo: ${new Date(window.dadosRelatorio.dataInicio).toLocaleDateString('pt-BR')} a ${new Date(window.dadosRelatorio.dataFim).toLocaleDateString('pt-BR')}`, 20, 35);
            
            // Resumo
            const resumo = window.dadosRelatorio.resumo;
            doc.text(`Total Vendas: R$ ${resumo.totalVendas.toFixed(2)}`, 20, 50);
            doc.text(`Total Entradas: R$ ${resumo.totalEntradas.toFixed(2)}`, 20, 60);
            doc.text(`Total Custos: R$ ${resumo.totalCustos.toFixed(2)}`, 20, 70);
            doc.text(`Lucro L√≠quido: R$ ${resumo.lucro.toFixed(2)}`, 20, 80);
            
            // Tabela
            const colunas = ['Data', 'Tipo', 'Descri√ß√£o', 'Qtd', 'Valor Unit.', 'Total'];
            const linhas = window.dadosRelatorio.dados.map(item => [
                new Date(item.data).toLocaleDateString('pt-BR'),
                item.tipo,
                item.descricao,
                item.quantidade.toString(),
                `R$ ${item.valorUnit.toFixed(2)}`,
                `R$ ${item.total.toFixed(2)}`
            ]);
            
            doc.autoTable({
                head: [colunas],
                body: linhas,
                startY: 90,
                styles: { fontSize: 8 },
                headStyles: { fillColor: [102, 126, 234] }
            });
            
            doc.save(`relatorio-pizzaria-${window.dadosRelatorio.dataInicio}-${window.dadosRelatorio.dataFim}.pdf`);
        }

        // Configura√ß√µes
        function atualizarContadores() {
            document.getElementById('count-entradas').textContent = entradas.length;
            document.getElementById('count-vendas').textContent = vendas.length;
            document.getElementById('count-custos').textContent = custos.length;
        }

        function exportarDados() {
            const dados = {
                entradas: entradas,
                vendas: vendas,
                custos: custos,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(dados, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `pizzaria-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importarDados() {
            document.getElementById('arquivo-importacao').click();
        }

        function processarImportacao() {
            const arquivo = document.getElementById('arquivo-importacao').files[0];
            if (!arquivo) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const dados = JSON.parse(e.target.result);
                    
                    if (dados.entradas) entradas = dados.entradas;
                    if (dados.vendas) vendas = dados.vendas;
                    if (dados.custos) custos = dados.custos;
                    
                    localStorage.setItem('pizzaria_entradas', JSON.stringify(entradas));
                    localStorage.setItem('pizzaria_vendas', JSON.stringify(vendas));
                    localStorage.setItem('pizzaria_custos', JSON.stringify(custos));
                    
                    atualizarContadores();
                    mostrarMensagemSucesso('Dados importados com sucesso!');
                } catch (error) {
                    alert('Erro ao importar dados. Verifique se o arquivo est√° correto.');
                }
            };
            reader.readAsText(arquivo);
        }

        function limparDados() {
            if (confirm('Tem certeza que deseja limpar TODOS os dados? Esta a√ß√£o n√£o pode ser desfeita!')) {
                if (confirm('CONFIRMA√á√ÉO FINAL: Todos os dados ser√£o perdidos permanentemente!')) {
                    entradas = [];
                    vendas = [];
                    custos = [];
                    
                    localStorage.removeItem('pizzaria_entradas');
                    localStorage.removeItem('pizzaria_vendas');
                    localStorage.removeItem('pizzaria_custos');
                    
                    atualizarContadores();
                    mostrarMensagemSucesso('Todos os dados foram limpos!');
                }
            }
        }

        function mostrarMensagemSucesso(mensagem) {
            const div = document.createElement('div');
            div.className = 'success-message';
            div.textContent = mensagem;
            
            const container = document.querySelector('.container');
            container.insertBefore(div, container.firstChild);
            
            setTimeout(() => {
                div.remove();
            }, 3000);
        }
    </script>
</body>
</html>
