<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Estoque - Pizzaria</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            width: 90%;
            max-width: 1200px;
            min-height: 600px;
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .screen {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .menu-card {
            background: linear-gradient(145deg, #f0f0f0, #ffffff);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
        }

        .menu-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            border-color: #667eea;
        }

        .menu-card h3 {
            color: #333;
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .menu-card p {
            color: #666;
            line-height: 1.6;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .btn-back {
            background: linear-gradient(145deg, #95a5a6, #7f8c8d);
        }

        .btn-danger {
            background: linear-gradient(145deg, #e74c3c, #c0392b);
        }

        .produtos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .produto-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ddd;
            transition: all 0.3s ease;
            text-align: center;
        }

        .produto-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .produto-item h4 {
            color: #333;
            margin-bottom: 5px;
            font-size: 1em;
        }

        .produto-item p {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .produto-item input {
            width: 70px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: center;
        }

        .section-title {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0 15px 0;
            text-align: center;
            font-weight: bold;
        }

        .funcionarios-section {
            background: #f1f3f4;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .funcionario-item {
            display: grid;
            grid-template-columns: 1fr auto auto;
            align-items: center;
            gap: 15px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .funcionario-info {
            display: flex;
            flex-direction: column;
        }

        .funcionario-info h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .funcionario-info p {
            color: #666;
            font-size: 0.9em;
        }

        .motoboys-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .motoboy-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e3f2fd;
            text-align: center;
            transition: all 0.3s ease;
        }

        .motoboy-card.active {
            border-color: #2196f3;
            background: #f3f8ff;
        }

        .motoboy-card h5 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .motoboy-controls {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .motoboy-controls label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 3px;
        }

        .motoboy-controls input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: center;
            font-size: 14px;
        }

        .motoboy-salary {
            margin-top: 8px;
            font-weight: bold;
            color: #2196f3;
            font-size: 0.9em;
        }

        .total-display {
            background: linear-gradient(145deg, #2ecc71, #27ae60);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            font-size: 1.5em;
            font-weight: bold;
        }

        .report-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .summary-card {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .summary-card h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .summary-card .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .report-table th,
        .report-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .report-table th {
            background: linear-gradient(145deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
        }

        .report-table tr:hover {
            background: #f8f9fa;
        }

        .entrada {
            color: #27ae60;
            font-weight: 600;
        }

        .saida {
            color: #e74c3c;
            font-weight: 600;
        }

        .funcionario {
            color: #f39c12;
            font-weight: 600;
        }

        .success-message {
            background: linear-gradient(145deg, #2ecc71, #27ae60);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            animation: slideIn 0.5s ease-in-out;
        }

        .data-management {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .data-management h4 {
            color: #333;
            margin-bottom: 15px;
        }

        .data-info {
            background: #e9ecef;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 0.9em;
            color: #666;
        }

        .data-info strong {
            color: #333;
        }

        .import-info {
            background: #e8f4fd;
            border: 2px solid #2196f3;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 0.9em;
            color: #1565c0;
            text-align: left;
        }

        .import-info h5 {
            color: #1565c0;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .import-info ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .import-info li {
            margin-bottom: 5px;
        }

        .import-options {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 0.9em;
            color: #856404;
            text-align: left;
        }

        .import-options h5 {
            color: #856404;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .import-options label {
            display: block;
            margin: 10px 0;
            cursor: pointer;
        }

        .import-options input[type="radio"] {
            margin-right: 8px;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Tela Principal -->
        <div id="main-screen" class="screen active">
            <div class="header">
                <h1>🍕 Sistema de Estoque</h1>
                <p>Pizzaria - Controle Completo</p>
            </div>
            
            <div class="menu-grid">
                <div class="menu-card" onclick="showScreen('rec1')">
                    <h3>📦 Entrada de Itens</h3>
                    <p>Registrar entrada de ingredientes e materiais no estoque</p>
                </div>
                
                <div class="menu-card" onclick="showScreen('fat1')">
                    <h3>🍕 Vendas</h3>
                    <p>Registrar vendas de produtos da pizzaria</p>
                </div>
                
                <div class="menu-card" onclick="showScreen('cust1')">
                    <h3>👥 Custos Pessoal</h3>
                    <p>Controlar despesas com motoboys e funcionários</p>
                </div>
                
                <div class="menu-card" onclick="showScreen('rel1')">
                    <h3>📊 Relatório Geral</h3>
                    <p>Visualizar relatórios detalhados por período</p>
                </div>
                
                <div class="menu-card" onclick="showScreen('config')">
                    <h3>⚙️ Configurações</h3>
                    <p>Gerenciar dados salvos e configurações do sistema</p>
                </div>
            </div>
        </div>

        <!-- Tela REC1 - Entrada de Itens -->
        <div id="rec1-screen" class="screen">
            <div class="header">
                <h1>📦 Entrada de Itens</h1>
                <p>Registrar entrada de ingredientes no estoque</p>
            </div>
            
            <form id="entrada-form">
                <div class="form-group">
                    <label for="item-select">Selecionar Item:</label>
                    <select id="item-select" required>
                         <option value="">Escolha um item...</option>
                        <option value="abacaxi">Abacaxi em calda</option>
                        <option value="alho-frito">Alho frito</option>
                        <option value="amendoim">Amendoim</option>
                        <option value="atum">Atum</option>
                        <option value="bacon">Bacon</option>
                        <option value="banana">Banana</option>
                        <option value="batata-palha">Batata palha</option>
                        <option value="bombom-branco">Bombom branco</option>
                        <option value="bombom-preto">Bombom preto</option>
                        <option value="brocolos">Brócolis</option>
                        <option value="calabresa">Calabresa</option>
                        <option value="bisnaga-chocolate">Bisnaga de chocolate</option>
                        <option value="cebola">Cebola</option>
                        <option value="cebola-caramelizada">Cebola caramelizada</option>
                        <option value="cebola-roxa">Cebola roxa</option>
                        <option value="champignon">Champignon</option>
                        <option value="chocolate-branco">Chocolate branco Nestlé</option>
                        <option value="chocolate-preto">Chocolate preto Nestlé</option>
                        <option value="chokito">Chokito</option>
                        <option value="coracao-frango">Coração de frango</option>
                        <option value="creme-leite">Creme de leite</option>
                        <option value="doritos">Doritos</option>
                        <option value="doce-leite">Doce de leite</option>
                        <option value="frango">Frango</option>
                        <option value="goiabada">Goiabada</option>
                        <option value="lombo">Lombo</option>
                        <option value="maca-verde">Maçã verde</option>
                        <option value="manjericao">Manjericão</option>
                        <option value="milho">Milho</option>
                        <option value="morango">Morango</option>
                        <option value="mussarela">Mussarela</option>
                        <option value="nozes">Nozes</option>
                        <option value="nutella">Nutella</option>
                        <option value="oregano">Orégano</option>
                        <option value="palmito">Palmito</option>
                        <option value="parmesao">Parmesão</option>
                        <option value="peito-peru">Peito de peru</option>
                        <option value="pepperoni">Pepperoni</option>
                        <option value="pimentao">Pimentão</option>
                        <option value="pimenta-calabresa">Pimenta calabresa</option>
                        <option value="presunto">Presunto</option>
                        <option value="provolone">Provolone</option>
                        <option value="queijo-cheddar">Queijo cheddar</option>
                        <option value="queijo-gorgonzola">Queijo gorgonzola</option>
                        <option value="requeijao">Requeijão</option>
                        <option value="rucula">Rúcula</option>
                        <option value="stikadinho">Stikadinho</option>
                        <option value="tomate">Tomate</option>
                        <option value="tomate-cereja">Tomate cereja</option>
                        <option value="tomate-seco">Tomate seco</option>
                        <option value="uva-verde">Uva verde</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="quantidade">Quantidade:</label>
                    <input type="number" id="quantidade" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="valor-unitario">Valor Unitário (R$):</label>
                    <input type="number" id="valor-unitario" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="data-entrada">Data:</label>
                    <input type="date" id="data-entrada" required>
                </div>
                
                <button type="submit" class="btn">💾 Registrar Entrada</button>
                <button type="button" class="btn btn-back" onclick="showScreen('main')">🔙 Voltar</button>
            </form>
        </div>

        <!-- Tela FAT1 - Vendas -->
        <div id="fat1-screen" class="screen">
            <div class="header">
                <h1>🍕 Registro de Vendas</h1>
                <p>Registrar vendas de produtos da pizzaria</p>
            </div>
            
            <form id="venda-form">
                <div class="section-title">🍕 PIZZAS</div>
                <div class="produtos-grid">
                    <div class="produto-item">
                        <h4>Pizza Pequena</h4>
                        <p>R$ 70,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="pizza-pequena" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                    
                    <div class="produto-item">
                        <h4>Pizza Média</h4>
                        <p>R$ 95,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="pizza-media" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                    
                    <div class="produto-item">
                        <h4>Pizza Grande</h4>
                        <p>R$ 105,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="pizza-grande" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                    
                    <div class="produto-item">
                        <h4>Pizza Gigante</h4>
                        <p>R$ 125,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="pizza-gigante" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                </div>

                <div class="section-title">🥟 ESFIRRAS</div>
                <div class="produtos-grid">
                    <div class="produto-item">
                        <h4>Esfirra Doce</h4>
                        <p>R$ 10,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="esfirra-doce" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                    
                    <div class="produto-item">
                        <h4>Esfirra Salgada</h4>
                        <p>R$ 10,00</p>
                        <label>Qtd:</label>
                        <input type="number" id="esfirra-salgada" min="0" value="0" onchange="calcularTotalVendas()">
                    </div>
                </div>
                
                <div class="total-display" id="total-vendas-display">
                    <strong>Total de Vendas: R$ 0,00</strong>
                </div>
                
                <div class="form-group">
                    <label for="data-venda">Data:</label>
                    <input type="date" id="data-venda" required>
                </div>
                
                <button type="submit" class="btn">💰 Registrar Vendas</button>
                <button type="button" class="btn btn-back" onclick="showScreen('main')">🔙 Voltar</button>
            </form>
        </div>

        <!-- Tela CUST1 - Custos com Pessoal -->
        <div id="cust1-screen" class="screen">
            <div class="header">
                <h1>👥 Custos com Pessoal</h1>
                <p>Controlar despesas com motoboys e funcionários</p>
            </div>
            
            <form id="custos-form">
                <div class="section-title">🏍️ MOTOBOYS</div>
                <div class="funcionarios-section">
                    <div class="funcionario-item">
                        <div class="funcionario-info">
                            <h4>Sistema de Pagamento</h4>
                            <p>R$ 70,00 até 7 entregas + R$ 10,00 por entrega extra</p>
                        </div>
                    </div>
                    
                    <div class="motoboys-grid">
                        <div class="motoboy-card" id="motoboy-1">
                            <h5>Motoboy 1</h5>
                            <div class="motoboy-controls">
                                <label>
                                    <input type="checkbox" id="motoboy-1-ativo" onchange="toggleMotoboy(1)"> Trabalhou hoje
                                </label>
                                <label>Entregas:</label>
                                <input type="number" id="motoboy-1-entregas" min="0" value="0" onchange="calcularTotalCustos()" disabled>
                                <div class="motoboy-salary" id="motoboy-1-salary">R$ 0,00</div>
                            </div>
                        </div>
                        
                        <div class="motoboy-card" id="motoboy-2">
                            <h5>Motoboy 2</h5>
                            <div class="motoboy-controls">
                                <label>
                                    <input type="checkbox" id="motoboy-2-ativo" onchange="toggleMotoboy(2)"> Trabalhou hoje
                                </label>
                                <label>Entregas:</label>
                                <input type="number" id="motoboy-2-entregas" min="0" value="0" onchange="calcularTotalCustos()" disabled>
                                <div class="motoboy-salary" id="motoboy-2-salary">R$ 0,00</div>
                            </div>
                        </div>
                        
                        <div class="motoboy-card" id="motoboy-3">
                            <h5>Motoboy 3</h5>
                            <div class="motoboy-controls">
                                <label>
                                    <input type="checkbox" id="motoboy-3-ativo" onchange="toggleMotoboy(3)"> Trabalhou hoje
                                </label>
                                <label>Entregas:</label>
                                <input type="number" id="motoboy-3-entregas" min="0" value="0" onchange="calcularTotalCustos()" disabled>
                                <div class="motoboy-salary" id="motoboy-3-salary">R$ 0,00</div>
                            </div>
                        </div>
                        
                        <div class="motoboy-card" id="motoboy-4">
                            <h5>Motoboy 4</h5>
                            <div class="motoboy-controls">
                                <label>
                                    <input type="checkbox" id="motoboy-4-ativo" onchange="toggleMotoboy(4)"> Trabalhou hoje
                                </label>
                                <label>Entregas:</label>
                                <input type="number" id="motoboy-4-entregas" min="0" value="0" onchange="calcularTotalCustos()" disabled>
                                <div class="motoboy-salary" id="motoboy-4-salary">R$ 0,00</div>
                            </div>
                        </div>
                        
                        <div class="motoboy-card" id="motoboy-5">
                            <h5>Motoboy 5</h5>
                            <div class="motoboy-controls">
                                <label>
                                    <input type="checkbox" id="motoboy-5-ativo" onchange="toggleMotoboy(5)"> Trabalhou hoje
                                </label>
                                <label>Entregas:</label>
                                <input type="number" id="motoboy-5-entregas" min="0" value="0" onchange="calcularTotalCustos()" disabled>
                                <div class="motoboy-salary" id="motoboy-5-salary">R$ 0,00</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-title">👨‍🍳 OUTROS FUNCIONÁRIOS</div>
                <div class="funcionarios-section">
                    <div class="funcionario-item">
                        <div class="funcionario-info">
                            <h4>👨‍🍳 Auxiliares de Cozinha</h4>
                            <p>R$ 80,00 por diária</p>
                        </div>
                        <div>
                            <label>Qtd Trabalhando:</label>
                            <input type="number" id="auxiliares-trabalhando" min="0" max="5" value="0" onchange="calcularTotalCustos()">
                        </div>
                        <div></div>
                    </div>
                </div>
                
                <div class="total-display" id="total-custos-display">
                    <div>Total Motoboys: R$ 0,00</div>
                    <div>Total Auxiliares: R$ 0,00</div>
                    <div style="border-top: 2px solid white; padding-top: 10px; margin-top: 10px;">
                        <strong>Total Custos Pessoal: R$ 0,00</strong>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="data-custos">Data:</label>
                    <input type="date" id="data-custos" required>
                </div>
                
                <button type="submit" class="btn">💼 Registrar Custos</button>
                <button type="button" class="btn btn-back" onclick="showScreen('main')">🔙 Voltar</button>
            </form>
        </div>

        <!-- Tela REL1 - Relatório Geral -->
        <div id="rel1-screen" class="screen">
            <div class="header">
                <h1>📊 Relatório Geral</h1>
                <p>Visualizar relatórios detalhados por período</p>
            </div>
            
            <div class="form-group">
                <label for="data-inicio">Data Início:</label>
                <input type="date" id="data-inicio" onchange="gerarRelatorio()">
            </div>
            
            <div class="form-group">
                <label for="data-fim">Data Fim:</label>
                <input type="date" id="data-fim" onchange="gerarRelatorio()">
            </div>
            
            <div id="relatorio-content">
                <div class="report-summary">
                    <div class="summary-card">
                        <h4>💰 Total Vendas</h4>
                        <div class="value" id="total-vendas-relatorio">R$ 0,00</div>
                    </div>
                    <div class="summary-card">
                        <h4>📦 Total Entradas</h4>
                        <div class="value" id="total-entradas-relatorio">R$ 0,00</div>
                    </div>
                    <div class="summary-card">
                        <h4>👥 Total Custos Pessoal</h4>
                        <div class="value" id="total-custos-relatorio">R$ 0,00</div>
                    </div>
                    <div class="summary-card">
                        <h4>📈 Lucro Bruto</h4>
                        <div class="value" id="lucro-bruto-relatorio">R$ 0,00</div>
                    </div>
                </div>
                
                <table class="report-table" id="tabela-relatorio">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Tipo</th>
                            <th>Descrição</th>
                            <th>Valor</th>
                        </tr>
                    </thead>
                    <tbody id="tbody-relatorio">
                    </tbody>
                </table>
            </div>
            
            <button type="button" class="btn" onclick="exportarPDF()">📄 Exportar PDF</button>
            <button type="button" class="btn btn-back" onclick="showScreen('main')">🔙 Voltar</button>
        </div>

        <!-- Tela de Configurações -->
        <div id="config-screen" class="screen">
            <div class="header">
                <h1>⚙️ Configurações</h1>
                <p>Gerenciar dados salvos e configurações do sistema</p>
            </div>
            
            <div class="data-management">
                <h4>📊 Gerenciamento de Dados</h4>
                
                <div class="data-info">
                    <strong>Status dos Dados:</strong><br>
                    <span id="status-dados">Carregando...</span>
                </div>
                
                <button type="button" class="btn" onclick="exportarDados()">💾 Exportar Dados</button>
                
                <div class="import-info">
                    <h5>📥 Importar Dados</h5>
                    <p><strong>Importante:</strong> A importação agora adiciona aos dados existentes sem apagar o que já foi registrado.</p>
                    <ul>
                        <li>O arquivo deve estar no formato JSON</li>
                        <li>Os dados importados serão <strong>adicionados</strong> aos registros atuais</li>
                        <li>Não haverá perda dos dados já existentes no sistema</li>
                        <li>Em caso de conflito de datas, você pode escolher como proceder</li>
                    </ul>
                </div>
                
                <div class="import-options" id="import-options" style="display: none;">
                    <h5>⚠️ Dados Duplicados Encontrados</h5>
                    <p>Foram encontrados registros com datas que já existem no sistema. Como deseja proceder?</p>
                    <label>
                        <input type="radio" name="merge-option" value="add" checked> 
                        Adicionar aos registros existentes (somar valores)
                    </label>
                    <label>
                        <input type="radio" name="merge-option" value="replace"> 
                        Substituir apenas os registros conflitantes
                    </label>
                    <label>
                        <input type="radio" name="merge-option" value="keep"> 
                        Manter dados existentes (ignorar conflitos)
                    </label>
                </div>
                
                <input type="file" id="file-input" accept=".json" style="display: none;" onchange="importarDados()">
                <button type="button" class="btn" onclick="document.getElementById('file-input').click()">📥 Importar Dados</button>
                
                <button type="button" class="btn btn-danger" onclick="limparDados()">🗑️ Limpar Todos os Dados</button>
            </div>
            
            <button type="button" class="btn btn-back" onclick="showScreen('main')">🔙 Voltar</button>
        </div>

        <!-- Mensagem de Sucesso -->
        <div id="success-message" class="success-message" style="display: none;"></div>
    </div>

    <script>
        // Variáveis globais para armazenar dados
        let dadosEntradas = [];
        let dadosVendas = [];
        let dadosCustos = [];
        let pendingImportData = null;

        // Inicializar sistema
        document.addEventListener('DOMContentLoaded', function() {
            carregarDados();
            atualizarStatusDados();
            
            // Definir data atual como padrão
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById('data-entrada').value = hoje;
            document.getElementById('data-venda').value = hoje;
            document.getElementById('data-custos').value = hoje;
        });

        // Função para mostrar telas
        function showScreen(screenId) {
            const screens = document.querySelectorAll('.screen');
            screens.forEach(screen => screen.classList.remove('active'));
            document.getElementById(screenId + '-screen').classList.add('active');
        }

        // Função para mostrar mensagem de sucesso
        function showSuccessMessage(message) {
            const successDiv = document.getElementById('success-message');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 3000);
        }

        // REC1 - Entrada de Itens
        document.getElementById('entrada-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const entrada = {
                id: Date.now(),
                item: document.getElementById('item-select').value,
                quantidade: parseFloat(document.getElementById('quantidade').value),
                valorUnitario: parseFloat(document.getElementById('valor-unitario').value),
                data: document.getElementById('data-entrada').value,
                valorTotal: parseFloat(document.getElementById('quantidade').value) * parseFloat(document.getElementById('valor-unitario').value)
            };
            
            dadosEntradas.push(entrada);
            salvarDados();
            
            showSuccessMessage('✅ Entrada registrada com sucesso!');
            this.reset();
            
            // Redefinir data atual
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById('data-entrada').value = hoje;
        });

        // FAT1 - Vendas
        function calcularTotalVendas() {
            const produtos = [
                { id: 'pizza-pequena', preco: 70.00 },
                { id: 'pizza-media', preco: 95.00 },
                { id: 'pizza-grande', preco: 105.00 },
                { id: 'pizza-gigante', preco: 125.00 },
                { id: 'esfirra-doce', preco: 10.00 },
                { id: 'esfirra-salgada', preco: 10.00 }
            ];
            
            let total = 0;
            produtos.forEach(produto => {
                const qtd = parseInt(document.getElementById(produto.id).value) || 0;
                total += qtd * produto.preco;
            });
            
            document.getElementById('total-vendas-display').innerHTML = 
                `<strong>Total de Vendas: R$ ${total.toFixed(2).replace('.', ',')}</strong>`;
        }

        document.getElementById('venda-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const produtos = [
                { id: 'pizza-pequena', nome: 'Pizza Pequena', preco: 70.00 },
                { id: 'pizza-media', nome: 'Pizza Média', preco: 95.00 },
                { id: 'pizza-grande', nome: 'Pizza Grande', preco: 105.00 },
                { id: 'pizza-gigante', nome: 'Pizza Gigante', preco: 125.00 },
                { id: 'esfirra-doce', nome: 'Esfirra Doce', preco: 10.00 },
                { id: 'esfirra-salgada', nome: 'Esfirra Salgada', preco: 10.00 }
            ];
            
            let vendaTotal = 0;
            let itensVendidos = [];
            
            produtos.forEach(produto => {
                const qtd = parseInt(document.getElementById(produto.id).value) || 0;
                if (qtd > 0) {
                    const valorItem = qtd * produto.preco;
                    vendaTotal += valorItem;
                    itensVendidos.push({
                        nome: produto.nome,
                        quantidade: qtd,
                        valorUnitario: produto.preco,
                        valorTotal: valorItem
                    });
                }
            });
            
            if (vendaTotal > 0) {
                const venda = {
                    id: Date.now(),
                    data: document.getElementById('data-venda').value,
                    itens: itensVendidos,
                    valorTotal: vendaTotal
                };
                
                dadosVendas.push(venda);
                salvarDados();
                
                showSuccessMessage('✅ Vendas registradas com sucesso!');
                
                // Limpar formulário
                produtos.forEach(produto => {
                    document.getElementById(produto.id).value = 0;
                });
                calcularTotalVendas();
                
                // Redefinir data atual
                const hoje = new Date().toISOString().split('T')[0];
                document.getElementById('data-venda').value = hoje;
            } else {
                alert('⚠️ Adicione pelo menos um produto para registrar a venda!');
            }
        });

        // CUST1 - Custos com Pessoal
        function toggleMotoboy(numero) {
            const checkbox = document.getElementById(`motoboy-${numero}-ativo`);
            const input = document.getElementById(`motoboy-${numero}-entregas`);
            const card = document.getElementById(`motoboy-${numero}`);
            
            if (checkbox.checked) {
                input.disabled = false;
                card.classList.add('active');
            } else {
                input.disabled = true;
                input.value = 0;
                card.classList.remove('active');
            }
            
            calcularTotalCustos();
        }

        function calcularTotalCustos() {
            let totalMotoboys = 0;
            
            // Calcular salários dos motoboys
            for (let i = 1; i <= 5; i++) {
                const checkbox = document.getElementById(`motoboy-${i}-ativo`);
                const entregas = parseInt(document.getElementById(`motoboy-${i}-entregas`).value) || 0;
                let salario = 0;
                
                if (checkbox.checked) {
                    if (entregas <= 7) {
                        salario = 70.00;
                    } else {
                        salario = 70.00 + ((entregas - 7) * 10.00);
                    }
                }
                
                totalMotoboys += salario;
                document.getElementById(`motoboy-${i}-salary`).textContent = 
                    `R$ ${salario.toFixed(2).replace('.', ',')}`;
            }
            
            // Calcular custos auxiliares
            const auxiliares = parseInt(document.getElementById('auxiliares-trabalhando').value) || 0;
            const totalAuxiliares = auxiliares * 80.00;
            
            const totalGeral = totalMotoboys + totalAuxiliares;
            
            document.getElementById('total-custos-display').innerHTML = `
                <div>Total Motoboys: R$ ${totalMotoboys.toFixed(2).replace('.', ',')}</div>
                <div>Total Auxiliares: R$ ${totalAuxiliares.toFixed(2).replace('.', ',')}</div>
                <div style="border-top: 2px solid white; padding-top: 10px; margin-top: 10px;">
                    <strong>Total Custos Pessoal: R$ ${totalGeral.toFixed(2).replace('.', ',')}</strong>
                </div>
            `;
        }

        document.getElementById('custos-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Coletar dados dos motoboys
            const motoboys = [];
            for (let i = 1; i <= 5; i++) {
                const checkbox = document.getElementById(`motoboy-${i}-ativo`);
                if (checkbox.checked) {
                    const entregas = parseInt(document.getElementById(`motoboy-${i}-entregas`).value) || 0;
                    let salario = 0;
                    
                    if (entregas <= 7) {
                        salario = 70.00;
                    } else {
                        salario = 70.00 + ((entregas - 7) * 10.00);
                    }
                    
                    motoboys.push({
                        numero: i,
                        entregas: entregas,
                        salario: salario
                    });
                }
            }
            
            const auxiliares = parseInt(document.getElementById('auxiliares-trabalhando').value) || 0;
            const totalAuxiliares = auxiliares * 80.00;
            const totalMotoboys = motoboys.reduce((sum, motoboy) => sum + motoboy.salario, 0);
            
            const custo = {
                id: Date.now(),
                data: document.getElementById('data-custos').value,
                motoboys: motoboys,
                auxiliares: {
                    quantidade: auxiliares,
                    valorTotal: totalAuxiliares
                },
                totalMotoboys: totalMotoboys,
                totalAuxiliares: totalAuxiliares,
                valorTotal: totalMotoboys + totalAuxiliares
            };
            
            dadosCustos.push(custo);
            salvarDados();
            
            showSuccessMessage('✅ Custos registrados com sucesso!');
            
            // Limpar formulário
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`motoboy-${i}-ativo`).checked = false;
                document.getElementById(`motoboy-${i}-entregas`).value = 0;
                document.getElementById(`motoboy-${i}`).classList.remove('active');
                toggleMotoboy(i);
            }
            document.getElementById('auxiliares-trabalhando').value = 0;
            calcularTotalCustos();
            
            // Redefinir data atual
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById('data-custos').value = hoje;
        });

        // REL1 - Relatórios
        function gerarRelatorio() {
            const dataInicio = document.getElementById('data-inicio').value;
            const dataFim = document.getElementById('data-fim').value;
            
            if (!dataInicio || !dataFim) return;
            
            // Filtrar dados por período
            const entradasFiltradas = dadosEntradas.filter(entrada => 
                entrada.data >= dataInicio && entrada.data <= dataFim
            );
            
            const vendasFiltradas = dadosVendas.filter(venda => 
                venda.data >= dataInicio && venda.data <= dataFim
            );
            
            const custosFiltrados = dadosCustos.filter(custo => 
                custo.data >= dataInicio && custo.data <= dataFim
            );
            
            // Calcular totais
            const totalEntradas = entradasFiltradas.reduce((sum, entrada) => sum + entrada.valorTotal, 0);
            const totalVendas = vendasFiltradas.reduce((sum, venda) => sum + venda.valorTotal, 0);
            const totalCustos = custosFiltrados.reduce((sum, custo) => sum + custo.valorTotal, 0);
            const lucroBruto = totalVendas - totalEntradas - totalCustos;
            
            // Atualizar resumos
            document.getElementById('total-vendas-relatorio').textContent = 
                `R$ ${totalVendas.toFixed(2).replace('.', ',')}`;
            document.getElementById('total-entradas-relatorio').textContent = 
                `R$ ${totalEntradas.toFixed(2).replace('.', ',')}`;
            document.getElementById('total-custos-relatorio').textContent = 
                `R$ ${totalCustos.toFixed(2).replace('.', ',')}`;
            document.getElementById('lucro-bruto-relatorio').textContent = 
                `R$ ${lucroBruto.toFixed(2).replace('.', ',')}`;
            
            // Gerar tabela
            const tbody = document.getElementById('tbody-relatorio');
            tbody.innerHTML = '';
            
            // Adicionar entradas
            entradasFiltradas.forEach(entrada => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${formatarData(entrada.data)}</td>
                    <td class="entrada">📦 Entrada</td>
                    <td>${entrada.item} (${entrada.quantidade}x)</td>
                    <td class="entrada">R$ ${entrada.valorTotal.toFixed(2).replace('.', ',')}</td>
                `;
            });
            
            // Adicionar vendas
            vendasFiltradas.forEach(venda => {
                const row = tbody.insertRow();
                const itensTexto = venda.itens.map(item => `${item.nome} (${item.quantidade}x)`).join(', ');
                row.innerHTML = `
                    <td>${formatarData(venda.data)}</td>
                    <td class="saida">💰 Venda</td>
                    <td>${itensTexto}</td>
                    <td class="saida">R$ ${venda.valorTotal.toFixed(2).replace('.', ',')}</td>
                `;
            });
            
            // Adicionar custos
            custosFiltrados.forEach(custo => {
                const row = tbody.insertRow();
                const motoboyTexto = custo.motoboys.length > 0 ? 
                    `${custo.motoboys.length} motoboy(s)` : '';
                const auxiliarTexto = custo.auxiliares.quantidade > 0 ? 
                    `${custo.auxiliares.quantidade} auxiliar(es)` : '';
                const descricaoTexto = [motoboyTexto, auxiliarTexto].filter(t => t).join(', ');
                
                row.innerHTML = `
                    <td>${formatarData(custo.data)}</td>
                    <td class="funcionario">👥 Pessoal</td>
                    <td>${descricaoTexto}</td>
                    <td class="funcionario">R$ ${custo.valorTotal.toFixed(2).replace('.', ',')}</td>
                `;
            });
        }

        function formatarData(data) {
            const [ano, mes, dia] = data.split('-');
            return `${dia}/${mes}/${ano}`;
        }

        function exportarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const dataInicio = document.getElementById('data-inicio').value;
            const dataFim = document.getElementById('data-fim').value;
            
            if (!dataInicio || !dataFim) {
                alert('⚠️ Selecione o período do relatório!');
                return;
            }
            
            // Título
            doc.setFontSize(20);
            doc.text('Relatório Geral - Pizzaria', 20, 20);
            
            doc.setFontSize(12);
            doc.text(`Período: ${formatarData(dataInicio)} a ${formatarData(dataFim)}`, 20, 35);
            
            // Resumo
            const totalVendas = document.getElementById('total-vendas-relatorio').textContent;
            const totalEntradas = document.getElementById('total-entradas-relatorio').textContent;
            const totalCustos = document.getElementById('total-custos-relatorio').textContent;
            const lucroBruto = document.getElementById('lucro-bruto-relatorio').textContent;
            
            doc.text(`Total Vendas: ${totalVendas}`, 20, 50);
            doc.text(`Total Entradas: ${totalEntradas}`, 20, 65);
            doc.text(`Total Custos Pessoal: ${totalCustos}`, 20, 80);
            doc.text(`Lucro Bruto: ${lucroBruto}`, 20, 95);
            
            // Tabela detalhada
            const tableData = [];
            const rows = document.querySelectorAll('#tbody-relatorio tr');
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                tableData.push([
                    cells[0].textContent,
                    cells[1].textContent,
                    cells[2].textContent,
                    cells[3].textContent
                ]);
            });
            
            doc.autoTable({
                head: [['Data', 'Tipo', 'Descrição', 'Valor']],
                body: tableData,
                startY: 110,
                styles: { fontSize: 8 }
            });
            
            doc.save(`relatorio-pizzaria-${dataInicio}-${dataFim}.pdf`);
        }

        // Funções de gerenciamento de dados
        function salvarDados() {
            const dados = {
                entradas: dadosEntradas,
                vendas: dadosVendas,
                custos: dadosCustos,
                versao: '1.0',
                ultimaAtualizacao: new Date().toISOString()
            };
            
            localStorage.setItem('sistemaPizzaria', JSON.stringify(dados));
            atualizarStatusDados();
        }

        function carregarDados() {
            const dadosSalvos = localStorage.getItem('sistemaPizzaria');
            if (dadosSalvos) {
                try {
                    const dados = JSON.parse(dadosSalvos);
                    dadosEntradas = dados.entradas || [];
                    dadosVendas = dados.vendas || [];
                    dadosCustos = dados.custos || [];
                } catch (error) {
                    console.error('Erro ao carregar dados:', error);
                    dadosEntradas = [];
                    dadosVendas = [];
                    dadosCustos = [];
                }
            }
        }

        function atualizarStatusDados() {
            const statusElement = document.getElementById('status-dados');
            const totalRegistros = dadosEntradas.length + dadosVendas.length + dadosCustos.length;
            
            if (totalRegistros === 0) {
                statusElement.innerHTML = '📊 Nenhum dado registrado ainda';
            } else {
                statusElement.innerHTML = `
                    📊 Total de ${totalRegistros} registros salvos<br>
                    📦 ${dadosEntradas.length} entradas | 💰 ${dadosVendas.length} vendas | 👥 ${dadosCustos.length} custos
                `;
            }
        }

        function exportarDados() {
            const dados = {
                entradas: dadosEntradas,
                vendas: dadosVendas,
                custos: dadosCustos,
                versao: '1.0',
                dataExportacao: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(dados, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup-pizzaria-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            URL.revokeObjectURL(url);
            showSuccessMessage('✅ Dados exportados com sucesso!');
        }

        function importarDados() {
            const fileInput = document.getElementById('file-input');
            const file = fileInput.files[0];
            
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const dadosImportados = JSON.parse(e.target.result);
                    
                    // Validar estrutura dos dados
                    if (!dadosImportados.entradas || !dadosImportados.vendas || !dadosImportados.custos) {
                        throw new Error('Arquivo inválido: estrutura de dados não reconhecida');
                    }
                    
                    // Verificar se há conflitos de data
                    const datasExistentes = new Set([
                        ...dadosEntradas.map(e => e.data),
                        ...dadosVendas.map(v => v.data),
                        ...dadosCustos.map(c => c.data)
                    ]);
                    
                    const datasImportadas = new Set([
                        ...dadosImportados.entradas.map(e => e.data),
                        ...dadosImportados.vendas.map(v => v.data),
                        ...dadosImportados.custos.map(c => c.data)
                    ]);
                    
                    const datasConflitantes = [...datasImportadas].filter(data => datasExistentes.has(data));
                    
                    if (datasConflitantes.length > 0) {
                        // Mostrar opções de merge
                        document.getElementById('import-options').style.display = 'block';
                        pendingImportData = dadosImportados;
                        
                        // Adicionar evento para processar a escolha
                        const processButton = document.createElement('button');
                        processButton.textContent = '✅ Confirmar Importação';
                        processButton.className = 'btn';
                        processButton.onclick = function() {
                            processarImportacao();
                            document.getElementById('import-options').style.display = 'none';
                            processButton.remove();
                        };
                        document.getElementById('import-options').appendChild(processButton);
                        
                        showSuccessMessage(`⚠️ Encontrados ${datasConflitantes.length} registros com datas conflitantes. Escolha como proceder acima.`);
                    } else {
                        // Não há conflitos, importar diretamente
                        pendingImportData = dadosImportados;
                        processarImportacao();
                    }
                    
                } catch (error) {
                    alert('❌ Erro ao importar dados: ' + error.message);
                }
            };
            
            reader.readAsText(file);
            fileInput.value = ''; // Limpar input
        }

        function processarImportacao() {
            if (!pendingImportData) return;
            
            const mergeOption = document.querySelector('input[name="merge-option"]:checked')?.value || 'add';
            
            // Processar entradas
            pendingImportData.entradas.forEach(novaEntrada => {
                const existeData = dadosEntradas.some(e => e.data === novaEntrada.data);
                
                if (!existeData || mergeOption === 'add') {
                    // Garantir ID único
                    novaEntrada.id = Date.now() + Math.random();
                    dadosEntradas.push(novaEntrada);
                } else if (mergeOption === 'replace') {
                    // Remover entradas da mesma data e adicionar as novas
                    dadosEntradas = dadosEntradas.filter(e => e.data !== novaEntrada.data);
                    novaEntrada.id = Date.now() + Math.random();
                    dadosEntradas.push(novaEntrada);
                }
                // Se for 'keep', não faz nada (mantém dados existentes)
            });
            
            // Processar vendas
            pendingImportData.vendas.forEach(novaVenda => {
                const existeData = dadosVendas.some(v => v.data === novaVenda.data);
                
                if (!existeData || mergeOption === 'add') {
                    novaVenda.id = Date.now() + Math.random();
                    dadosVendas.push(novaVenda);
                } else if (mergeOption === 'replace') {
                    dadosVendas = dadosVendas.filter(v => v.data !== novaVenda.data);
                    novaVenda.id = Date.now() + Math.random();
                    dadosVendas.push(novaVenda);
                }
            });
            
            // Processar custos
            pendingImportData.custos.forEach(novoCusto => {
                const existeData = dadosCustos.some(c => c.data === novoCusto.data);
                
                if (!existeData || mergeOption === 'add') {
                    novoCusto.id = Date.now() + Math.random();
                    dadosCustos.push(novoCusto);
                } else if (mergeOption === 'replace') {
                    dadosCustos = dadosCustos.filter(c => c.data !== novoCusto.data);
                    novoCusto.id = Date.now() + Math.random();
                    dadosCustos.push(novoCusto);
                }
            });
            
            // Salvar dados atualizados
            salvarDados();
            
            const totalImportados = pendingImportData.entradas.length + 
                                  pendingImportData.vendas.length + 
                                  pendingImportData.custos.length;
            
            showSuccessMessage(`✅ ${totalImportados} registros importados com sucesso!`);
            
            // Limpar dados pendentes
            pendingImportData = null;
        }

        function limparDados() {
            if (confirm('⚠️ Tem certeza que deseja limpar TODOS os dados? Esta ação não pode ser desfeita!')) {
                if (confirm('🚨 CONFIRMAÇÃO FINAL: Todos os dados serão perdidos permanentemente!')) {
                    dadosEntradas = [];
                    dadosVendas = [];
                    dadosCustos = [];
                    localStorage.removeItem('sistemaPizzaria');
                    atualizarStatusDados();
                    showSuccessMessage('🗑️ Todos os dados foram removidos!');
                }
            }
        }

        // Event listeners adicionais
        document.getElementById('data-inicio').addEventListener('change', gerarRelatorio);
        document.getElementById('data-fim').addEventListener('change', gerarRelatorio);

        // Adicionar event listeners para cálculos automáticos
        document.getElementById('quantidade').addEventListener('input', function() {
            const quantidade = parseFloat(this.value) || 0;
            const valorUnitario = parseFloat(document.getElementById('valor-unitario').value) || 0;
            const total = quantidade * valorUnitario;
            // Você pode adicionar um campo para mostrar o total se desejar
        });

        document.getElementById('valor-unitario').addEventListener('input', function() {
            const quantidade = parseFloat(document.getElementById('quantidade').value) || 0;
            const valorUnitario = parseFloat(this.value) || 0;
            const total = quantidade * valorUnitario;
            // Você pode adicionar um campo para mostrar o total se desejar
        });

        // Event listeners para cálculos automáticos de vendas
        const produtosVenda = ['pizza-pequena', 'pizza-media', 'pizza-grande', 'pizza-gigante', 'esfirra-doce', 'esfirra-salgada'];
        produtosVenda.forEach(produto => {
            document.getElementById(produto).addEventListener('input', calcularTotalVendas);
        });

        // Event listeners para cálculos automáticos de custos
        document.getElementById('auxiliares-trabalhando').addEventListener('input', calcularTotalCustos);

        for (let i = 1; i <= 5; i++) {
            document.getElementById(`motoboy-${i}-entregas`).addEventListener('input', calcularTotalCustos);
        }
    </script>
</body>
</html>
